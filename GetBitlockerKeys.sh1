#Ask for hostname of the computer
$hostname = Read-Host -Prompt ‘Enter hostname’

# Get Computer Object
$computer = Get-ADComputer -Filter {Name -eq $hostname}

# Get all BitLocker Recovery Keys for that Computer. Note the 'SearchBase' parameter
$BitLockerObjects = Get-ADObject -Filter {objectclass -eq 'msFVE-RecoveryInformation'} -SearchBase $computer.DistinguishedName -Properties 'msFVE-RecoveryPassword'

# Output the results!
$BitLockerObjects | Export-Csv 'bitlocker.csv'
